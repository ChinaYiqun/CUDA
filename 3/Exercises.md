## 练习题

1. 在本章中，我们实现了一个矩阵乘法核函数，让每个线程产生一个输出矩阵元素。在这个问题中，你将实现不同的矩阵-矩阵乘法核函数并比较它们。
   - a. 编写一个核函数，让每个线程产生一个输出矩阵行。填写设计的执行配置参数。
   - b. 编写一个核函数，让每个线程产生一个输出矩阵列。填写设计的执行配置参数。
   - c. 分析这两种核函数设计的优缺点。

2. 矩阵-向量乘法接受一个输入矩阵B和一个向量C，并产生一个输出向量A。输出向量A的每个元素是输入矩阵B的一行与C的点积，即A[i]=Σj(B[i][j] * C[j])。
   为了简化，我们只处理元素为单精度浮点数的方阵。编写一个矩阵-向量乘法核函数和主机存根函数，该函数可以用四个参数调用：指向输出矩阵的指针，指向输入矩阵的指针，指向输入向量的指针，以及每个维度的元素数量。使用一个线程来计算一个输出向量元素。

3. 考虑以下CUDA核函数及其对应的主机函数：
   - a. 每个块中的线程数量是多少？
   - b. 网格中的线程总数是多少？
   - c. 网格中的块数量是多少？
   - d. 执行第05行代码的线程数量是多少？

a. 512 : 每个块中的线程数量是由bd变量指定的，它是通过dim3构造函数dim3(16,32)初始化的。因此，每个块中的线程数量是16  32 = 512。
b. 48640:网格中的线程总数是由gd变量和bd变量共同决定的。gd变量是通过dim3((N - 1) / 16 + 1, (M - 1) / 32 + 1)初始化的，其中N = 300和M = 150。因此，网格的维度是((300 - 1) / 16 + 1)  ((150 - 1) / 32 + 1)。
计算网格的维度：
   - 对于N，我们有(300 - 1) / 16 + 1 = 19（因为299 / 16 = 18.6875，向上取整得到19）。
   - 对于M，我们有(150 - 1) / 32 + 1 = 5（因为149 / 32 = 4.65625，向上取整得到5）。
   所以，网格的维度是19  5，即95个块。
   由于每个块有512个线程，网格中的线程总数是95  512 = 48640。
c. 95
4. 考虑一个宽度为400，高度为500的2D矩阵。矩阵以一维数组的形式存储。指定第20行第10列的矩阵元素的数组索引：
   - a. 如果矩阵按行优先顺序存储。
   - b. 如果矩阵按列优先顺序存储。

5. 考虑一个宽度为400，高度为500，深度为300的3D张量。张量以行优先顺序的一维数组形式存储。指定x=10，y=20，z=5的张量元素的数组索引。